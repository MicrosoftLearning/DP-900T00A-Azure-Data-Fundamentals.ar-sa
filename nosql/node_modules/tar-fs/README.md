---
ms.openlocfilehash: 841a4ef811cc186a2302309fbbc4a380d1ba5cbd
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/05/2022
ms.locfileid: "138049922"
---
# <a name="tar-fs"></a>tar-fs

روابط نظام الملفات [tar-stream](https://github.com/mafintosh/tar-stream).

```
npm install tar-fs
```

[![build status](https://secure.travis-ci.org/mafintosh/tar-fs.png)](http://travis-ci.org/mafintosh/tar-fs)

## <a name="usage"></a>الاستخدام

يسمح لك tar-fs بتعبئة الدلائل في tarballs واستخراج tarballs في الأدلة.

إنه لا يقوم بـgunzip من أجلك، لذلك إذا كنت ترغب في استخراج `.tar.gz` مع هذا، فستحتاج إلى استخدام شيء مثل [gunzip-maybe](https://github.com/mafintosh/gunzip-maybe) بالإضافة إلى ذلك.

``` js
var tar = require('tar-fs')
var fs = require('fs')

// packing a directory
tar.pack('./my-directory').pipe(fs.createWriteStream('my-tarball.tar'))

// extracting a directory
fs.createReadStream('my-other-tarball.tar').pipe(tar.extract('./my-other-directory'))
```

لتجاهل الملفات المختلفة عند التعبئة أو الاستخراج، أضف وظيفة تجاهل إلى الخيارات. `ignore` هو أيضًا اسم مستعار لـ`filter`. بالإضافة إلى ذلك، يمكنك الحصول على `header` ما إذا كنت تستخدم التجاهل أثناء الاستخراج.
وبهذه الطريقة يمكنك أيضاً التصفية حسب البيانات الوصفية.

``` js
var pack = tar.pack('./my-directory', {
  ignore: function(name) {
    return path.extname(name) === '.bin' // ignore .bin files when packing
  }
})

var extract = tar.extract('./my-other-directory', {
  ignore: function(name) {
    return path.extname(name) === '.bin' // ignore .bin files inside the tarball when extracing
  }
})

var extractFilesDirs = tar.extract('./my-other-other-directory', {
  ignore: function(_, header) {
    // pass files & directories, ignore e.g. symlinks
    return header.type !== 'file' && header.type !== 'directory'
  }
})
```

يمكنك أيضاً تحديد الإدخالات التي تريد حزمها باستخدام الخيار `entries`

```js
var pack = tar.pack('./my-directory', {
  entries: ['file1', 'subdir/file2'] // only the specific entries will be packed
})
```

إذا كنت ترغب في تعديل العناوين عند التعبئة/الاستخراج أضف وظيفة خريطة إلى الخيارات

``` js
var pack = tar.pack('./my-directory', {
  map: function(header) {
    header.name = 'prefixed/'+header.name
    return header
  }
})

var extract = tar.extract('./my-directory', {
  map: function(header) {
    header.name = 'another-prefix/'+header.name
    return header
  }
})
```

وبالمثل، يمكنك استخدام `mapStream` في حالة رغبتك في تعديل تدفقات ملفات الإدخال / الإخراج

``` js
var pack = tar.pack('./my-directory', {
  mapStream: function(fileStream, header) {
    // NOTE: the returned stream HAS to have the same length as the input stream.
    // If not make sure to update the size in the header passed in here.
    if (path.extname(header.name) === '.js') {
      return fileStream.pipe(someTransform)
    }
    return fileStream;
  }
})

var extract = tar.extract('./my-directory', {
  mapStream: function(fileStream, header) {
    if (path.extname(header.name) === '.js') {
      return fileStream.pipe(someTransform)
    }
    return fileStream;
  }
})
```

تعيين `options.fmode` و`options.dmode` للتأكد من أن الملفات / الدلائل المستخرجة لها الأوضاع المقابلة

``` js
var extract = tar.extract('./my-directory', {
  dmode: parseInt(555, 8), // all dirs should be readable
  fmode: parseInt(444, 8) // all files should be readable
})
```

قد يكون من المفيد استخدامه `dmode` و`fmode` إذا كنت تقوم بتعبئة / تفريغ كرات القطران بين * nix / windows للتأكد من أن جميع الملفات / الدلائل التي تم تفكيكها قابلة للقراءة.

بدلاً من ذلك، يمكنك تعيين `options.readable` و / أو `options.writable` لتعيين dmode وfmode إلى قابل للقراءة / قابل للكتابة.

``` js
var extract = tar.extract('./my-directory', {
  readable: true, // all dirs and files should be readable
  writable: true, // all dirs and files should be writable
})
```

تعيين `options.strict` إلى `false` إذا كنت تريد تجاهل الأخطاء بسبب أنواع الإدخال غير المدعومة (مثل ملفات الجهاز)

لإلغاء الإشارة إلى الارتباطات الرمزية (حزم محتويات الارتباط الرمزي بدلا من الارتباط نفسه) المعينة `options.dereference` إلى `true`.

## <a name="copy-a-directory"></a>نسخ دليل

يعد نسخ دليل مع أذونات وmtime سليمًا أمرًا بسيطًا مثل

``` js
tar.pack('source-directory').pipe(tar.extract('dest-directory'))
```

## <a name="interaction-with-tar-stream"></a>التفاعل مع [`tar-stream`](https://github.com/mafintosh/tar-stream)

استخدم `finalize: false` والخطاف `finish` لترك دفق الحزمة مفتوحاً لمزيد من الإدخالات (انظر [`tar-stream#pack`](https://github.com/mafintosh/tar-stream#packing))، واستخدم `pack` لتمرير دفق حزمة موجود.

``` js
var mypack = tar.pack('./my-directory', {
  finalize: false,
  finish: function(sameAsMypack) {
    mypack.entry({name: 'generated-file.txt'}, "hello")
    tar.pack('./other-directory', {
      pack: sameAsMypack
    })
  }
})
```


## <a name="performance"></a>الأداء

ينتج عن تعبئة واستخراج 6.1 غيغابايت مع 2496 دليلاً و2398 ملفاً النتائج التالية على جهاز Macbook Air الخاص بي.
[راجع المقياس هنا](https://gist.github.com/mafintosh/8102201)

* tar-fs: 34.261 seconds
* [node-tar](https://github.com/isaacs/node-tar): 366.123 ثانية (أو 10x أبطأ)

## <a name="license"></a>الترخيص

معهد ماساتشوستس للتكنولوجيا
