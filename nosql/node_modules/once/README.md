---
ms.openlocfilehash: 69b0a9165715c6cd0e8de37ddb4abad94de2b102
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/05/2022
ms.locfileid: "138049955"
---
# <a name="once"></a>مرة واحدة

استدعاء دالة مرة واحدة فقط.

## <a name="usage"></a>الاستخدام

```javascript
var once = require('once')

function load (file, cb) {
  cb = once(cb)
  loader.load('file')
  loader.once('load', cb)
  loader.once('error', cb)
}
```

أو أضف إلى Function.prototype بطريقة مسؤولة:

```javascript
// only has to be done once
require('once').proto()

function load (file, cb) {
  cb = cb.once()
  loader.load('file')
  loader.once('load', cb)
  loader.once('error', cb)
}
```

ومن المفارقات أن ميزة النموذج الأولي تجعل هذه الوحدة أكثر تعقيدًا مرتين حسب الضرورة.

للتحقق مما إذا كان قد تم استدعاء الوظيفة، استخدم `fn.called`. بمجرد استدعاء الدالة لأول مرة يتم حفظ قيمة الإرجاع للدالة الأصلية في `fn.value` وستستمر الاستدعاءات اللاحقة في إرجاع هذه القيمة.

```javascript
var once = require('once')

function load (cb) {
  cb = once(cb)
  var stream = createStream()
  stream.once('data', cb)
  stream.once('end', function () {
    if (!cb.called) cb(new Error('not found'))
  })
}
```

## `once.strict(func)`

قم برمي خطأ إذا تم استدعاء الدالة مرتين.

من المتوقع أن يتم استدعاء بعض الوظائف مرة واحدة فقط. من المحتمل أن يؤدي استخدام `once` إلى إخفاء الأخطاء المنطقية.

في المثال أدناه، يجب على الدالة `greet` استدعاء معاودة الاتصال مرة واحدة فقط:

```javascript
function greet (name, cb) {
  // return is missing from the if statement
  // when no name is passed, the callback is called twice
  if (!name) cb('Hello anonymous')
  cb('Hello ' + name)
}

function log (msg) {
  console.log(msg)
}

// this will print 'Hello anonymous' but the logical error will be missed
greet(null, once(msg))

// once.strict will print 'Hello anonymous' and throw an error when the callback will be called the second time
greet(null, once.strict(msg))
```
