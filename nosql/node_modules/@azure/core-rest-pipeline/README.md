---
ms.openlocfilehash: 6f2950dcb9eebd8a8a946f99370300d10624b1c2
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052948"
---
# <a name="azure-core-http-client-library-for-javascript-experimental"></a>مكتبة عميل Azure Core HTTP لجافا سكريبت (تجريبية)

هذا هو خط أنابيب HTTP الأساسي لمكتبات Azure SDK JavaScript التي تعمل في المتصفح Node.js. تهدف هذه المكتبة في المقام الأول إلى استخدامها في التعليمات البرمجية التي تم إنشاؤها بواسطة [AutoRest](https://github.com/Azure/Autorest) و[`autorest.typescript`](https://github.com/Azure/autorest.typescript).

## <a name="getting-started"></a>الشروع في العمل

### <a name="requirements"></a>المتطلبات

### <a name="currently-supported-environments"></a>البيئات المعتمدة حاليًا

- [إصدارات "LTS" من "Node.js"](https://nodejs.org/about/releases/).
- آخر إصدارات Safari وChrome وEdge وFirefox.

راجع [سياسة الدعم](https://github.com/Azure/azure-sdk-for-js/blob/main/SUPPORT.md) الخاصة بنا لمزيد من التفاصيل.

### <a name="installation"></a>التثبيت

تستخدم هذه الحزمة في المقام الأول في التعليمات البرمجية التي تم إنشاؤها وليس المقصود أن يستهلكها المستخدمون النهائيون مباشرة.

## <a name="key-concepts"></a>المفاهيم الرئيسية

### <a name="pipelinerequest"></a>PipelineRequest

`PipelineRequest` يصف كافة المعلومات اللازمة لتقديم طلب إلى نقطة نهاية HTTP REST.

### <a name="pipelineresponse"></a>PipelineResponse

`PipelineResponse` يصف استجابة HTTP (النص الأساسي والرؤوس ورمز الحالة) من نقطة نهاية REST التي تم إرجاعها بعد إجراء طلب HTTP.

### <a name="sendrequest"></a>SendRequest

الطريقة `SendRequest` هي طريقة يمكن أن تؤدي إلى جعل `PipelineRequest` يرجع `PipelineResponse`بشكل غير متزامن.

```ts
export type SendRequest = (request: PipelineRequest) => Promise<PipelineResponse>;
```

### <a name="httpclient"></a>HttpClient

`HttpClient` هو أي كائن يلبي الواجهة التالية لتنفيذ طريقة `SendRequest`:

```ts
export interface HttpClient {
  /**
   * The method that makes the request and returns a response.
   */
  sendRequest: SendRequest;
}
```

`HttpClient`من المتوقع أن تقوم بالفعل بتقديم طلب HTTP إلى نقطة نهاية الخادم، باستخدام بعض الآليات الخاصة بالنظام الأساسي للقيام بذلك.

### <a name="pipeline-policies"></a>سياسات خطوط الأنابيب

`PipelinePolicy` هو كائن بسيط ينفذ الواجهة التالية:

```ts
export interface PipelinePolicy {
  /**
   * The policy name. Must be a unique string in the pipeline.
   */
  name: string;
  /**
   * The main method to implement that manipulates a request/response.
   * @param request The request being performed.
   * @param next The next policy in the pipeline. Must be called to continue the pipeline.
   */
  sendRequest(request: PipelineRequest, next: SendRequest): Promise<PipelineResponse>;
}
```

وهو مشابه في الشكل لـ`HttpClient`، ولكنه يتضمن اسم سياسة بالإضافة إلى توقيع معدل `SendRequest` قليلاً يسمح له باستدعاء السياسة التالية في خط الأنابيب بشكل مشروط.

يمكن للمرء أن ينظر إلى دور السياسات مثل `middleware`، مفهوم مألوف لمطوري NodeJS الذين عملوا مع أطر عمل مثل [Express](https://expressjs.com/).

يمكن للتنفيذ `sendRequest` تحويل الطلب الصادر وكذلك الاستجابة الواردة:

```ts
const customPolicy = {
  name: "My wonderful policy",
  async sendRequest(request: PipelineRequest, next: SendRequest): Promise<PipelineResponse> {
    // Change the outgoing request by adding a new header
    request.headers.set("X-Cool-Header", 42);
    const result = await next(request);
    if (response.status === 403) {
      // Do something special if this policy sees Forbidden
    }
    return result;
  }
};
```

تهتم معظم السياسات فقط إما بالطلب أو الاستجابة، ولكن هناك بعض الاستثناءات مثل [LogPolicy](https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/core/core-rest-pipeline/src/policies/logPolicy.ts) الذي يسجل المعلومات من كل منها.

### <a name="pipelines"></a>التدفقات

`Pipeline` هو كائن يدير مجموعة من الكائنات `PipelinePolicy`. وتتمثل مهمتها الرئيسية في ضمان تنفيذ السياسات بترتيب متسق ويمكن التنبؤ به.

يمكنك التفكير في السياسات التي تطبع كأنها مكدس (first-in/last-out.) الأول `PipelinePolicy` قادر على تعديل `PipelineRequest` قبل أي سياسة أخرى، وهو أيضًا الأخير لتعديل `PipelineResponse`، ما يجعله الأقرب للمستدعي. السياسة النهائية هي الأخيرة القادرة على تعديل الطلب الصادر، والأولى للتعامل مع الاستجابة، مما يجعلها الأقرب إلى الشبكة.

`Pipeline` يلبي الواجهة التالية:

```ts
export interface Pipeline {
  addPolicy(policy: PipelinePolicy, options?: AddPolicyOptions): void;
  removePolicy(options: { name?: string; phase?: PipelinePhase }): PipelinePolicy[];
  sendRequest(httpClient: HttpClient, request: PipelineRequest): Promise<PipelineResponse>;
  getOrderedPolicies(): PipelinePolicy[];
  clone(): Pipeline;
}
```

كما ترون، فإنه يسمح بإضافة السياسات أو إزالتها ويقترن بـ`HttpClient` بشكل فضفاض بتنفيذ الطلب الحقيقي إلى نقطة نهاية الخادم.

أحد المفاهيم المهمة بالنسبة لـ`Pipeline` هو أنها تجمع السياسات في مراحل مرتبة:

1. مرحلة التسلسل
2. السياسات التي ليست في مرحلة
3. مرحلة إلغاء التسلسل
4. مرحلة إعادة المحاولة

تحدث المراحل بالترتيب أعلاه، مع تطبيق سياسات التسلسل أولاً وتطبيق سياسات إعادة المحاولة أخيراً. تقع معظم السياسات المخصصة في الحاوية الثانية ولا يتم إعطاؤها اسم مرحلة.

عند إضافة نهج إلى خط الأنابيب، يمكنك تحديد ليس فقط المرحلة التي تمر بها السياسة، ولكن أيضا ما إذا كانت لها أي تبعيات:

```ts
export interface AddPolicyOptions {
  beforePolicies?: string[];
  afterPolicies?: string[];
  afterPhase?: PipelinePhase;
  phase?: PipelinePhase;
}
```

`beforePolicies` هي السياسات التي يجب أن تنفذها السياسة الجديدة من قبل و`afterPolicies` هي السياسات التي يجب أن تحدث السياسة الجديدة بعدها. وبالمثل، `afterPhase` يعني أن السياسة يجب أن تنفذ فقط بعد حدوث المرحلة المحددة.

يسمح بناء الجملة هذا لمؤلفي السياسة المخصصة بالتعبير عن أي علاقات ضرورية بين سياساتهم الخاصة والسياسات المضمنة التي يوفرها `@azure/core-rest-pipeline` عند إنشاء خط أنابيب باستخدام `createPipelineFromOptions`.

يمكن للمنفذين أيضاً إزالة السياسات بالاسم أو المرحلة، في حالة رغبتهم في تعديل `Pipeline` موجود دون الحاجة إلى إنشاء نهج جديد باستخدام `createEmptyPipeline`. الطريقة `clone` مفيدة بشكل خاص عند إعادة إنشاء `Pipeline` دون تعديل الأصل.

بعد استيفاء جميع القيود الأخرى، يتم تطبيق السياسات بالترتيب الذي تمت إضافته به.

## <a name="examples"></a>أمثلة

يمكن العثور على أمثلة في المجلد `samples`.

## <a name="next-steps"></a>الخطوات التالية

يمكنك إنشاء الاختبارات وتشغيلها محليا عن طريق تنفيذ `rushx test`. استكشف المجلد `test` للاطلاع على الاستخدام والسلوك المتقدم للفئات العامة.

## <a name="troubleshooting"></a>استكشاف الأخطاء وإصلاحها

إذا واجهت مشكلات في أثناء استخدام هذه المكتبة، فلا تتردد [في تقديم مشكلة](https://github.com/Azure/azure-sdk-for-js/issues/new).

## <a name="contributing"></a>المساهمة

إذا كنت ترغب في المساهمة في هذه المكتبة، يرجى قراءة [دليل المساهمة](https://github.com/Azure/azure-sdk-for-js/blob/main/CONTRIBUTING.md) لمعرفة المزيد حول كيفية إنشاء التعليمات البرمجية واختبارها.

![مرات الظهور](https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js%2Fsdk%2Fcore%2Fcore-rest-pipeline%2FREADME.png)
