---
ms.openlocfilehash: cbc289a6b02d7acb0ad82e3a95bde8846fcff55e
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/05/2022
ms.locfileid: "138049933"
---
# <a name="node-jws-build-statushttptravis-ciorgbrianloveswordsnode-jws"></a>node-jws [![Build Status](https://secure.travis-ci.org/brianloveswords/node-jws.png)](http://travis-ci.org/brianloveswords/node-jws)

تنفيذ [توقيعات الويب JSON](http://self-issued.info/docs/draft-ietf-jose-json-web-signature.html).

تم تطوير هذا ضد `draft-ietf-jose-json-web-signature-08` وتنفيذ المواصفات بأكملها **باستثناء** توقيع / التحقق من سلسلة شهادات X.509 (نرحب بالتصحيحات).

هناك كل من واجهات برمجة التطبيقات المتزامنة (`jws.sign`, `jws.verify`) وواجهات برمجة التطبيقات المتدفقة (`jws.createSign`, `jws.createVerify`).

# <a name="install"></a>تثبيت

```bash
$ npm install jws
```

# <a name="usage"></a>الاستخدام

## <a name="jwsalgorithms"></a>jws.ALGORITHMS

مجموعة من الخوارزميات المدعومة. يتم دعم الخوارزميات التالية حاليًا.

قيمة المعلمة alg | التوقيع الرقمي أو خوارزمية MAC
----------------|----------------------------
HS256 | HMAC باستخدام خوارزمية التجزئة SHA-256
HS384 | HMAC باستخدام خوارزمية التجزئة SHA-384
HS512 | HMAC باستخدام خوارزمية التجزئة SHA-512
RS256 | RSASSA باستخدام خوارزمية التجزئة SHA-256
RS384 | RSASSA باستخدام خوارزمية التجزئة SHA-384
RS512 | RSASSA باستخدام خوارزمية التجزئة SHA-512
PS256 | RSASSA باستخدام خوارزمية التجزئة SHA-256
PS384 | RSASSA باستخدام خوارزمية التجزئة SHA-384
PS512 | RSASSA باستخدام خوارزمية التجزئة SHA-512
ES256 | ECDSA باستخدام منحنى P-256 وخوارزمية التجزئة SHA-256
ES384 | ECDSA باستخدام منحنى P-384 وخوارزمية التجزئة SHA-384
ES512 | ECDSA باستخدام منحنى P-521 وخوارزمية التجزئة SHA-512
بلا | لا يتضمن التوقيع الرقمي أو قيمة MAC

## <a name="jwssignoptions"></a>jws.sign(options)

(متزامن) إرجاع توقيع ويب JSON لرأس وحمولة.

خيارات:

* `header`
* `payload`
* `secret` أو `privateKey`
* `encoding` (Optional, defaults to 'utf8')

يجب أن يكون `header` كائنًا له خاصية `alg`. يجب أن تكون `header.alg` واحدة قيمة موجودة في `jws.ALGORITHMS`. انظر أعلاه للحصول على جدول الخوارزميات المدعومة.

إذا لم يكن `payload` مخزن مؤقت أو سلسلة، يتم إجباره إلى سلسلة باستخدام `JSON.stringify`.

مثال

```js
const signature = jws.sign({
  header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  secret: 'has a van',
});
```

## <a name="jwsverifysignature-algorithm-secretorkey"></a>jws.verify(signature, algorithm, secretOrKey)

(متزامن) إرجاع `true` أو `false` لمعرفة ما إذا كان التوقيع يتطابق مع سر أو مفتاح.

`signature` هو توقيع JWS. يجب أن تكون `header.alg` قيمة موجودة في `jws.ALGORITHMS`.
انظر أعلاه للحصول على جدول الخوارزميات المدعومة. `secretOrKey` عبارة عن سلسلة أو مخزن مؤقت يحتوي إما على سر خوارزميات HMAC، أو المفتاح العام المشفر PEM لـRSA وECDSA.

لاحظ أنه يتم تجاهل القيمة `"alg"` من رأس التوقيع.


## <a name="jwsdecodesignature"></a>jws.decode(signature)

(متزامن) ترجع هذه الدالة الرأس الذي تم فك تشفيره والحمولة الصافية التي تم فك تشفيرها وأجزاء التوقيع الخاصة بتوقيع JWS.

إرجاع كائن له ثلاث خصائص، على سبيل المثال.
```js
{ header: { alg: 'HS256' },
  payload: 'h. jon benjamin',
  signature: 'YOWPewyGHKu4Y_0M_vtlEnNlqmFOclqp4Hy6hVHfFT4'
}
```

## <a name="jwscreatesignoptions"></a>jws.createSign(options)

إرجاع كائن SignStream جديد.

خيارات:

* `header` (مطلوب)
* `payload`
* `key` || `privateKey` || `secret`
* `encoding` (Optional, defaults to 'utf8')

بخلاف ذلك `header`، تتوقع جميع الخيارات سلسلة أو مخزن مؤقت عندما تكون القيمة معروفة في وقت مبكر، أو دفق للراحة.
`key`/`privateKey`/`secret` قد يكون أيضًا كائنًا عند استخدام مفتاح خاص مشفر، راجع [وثائق التشفير][encrypted-key-docs].

مثال:

```js

// This...
jws.createSign({
  header: { alg: 'RS256' },
  privateKey: privateKeyStream,
  payload: payloadStream,
}).on('done', function(signature) {
  // ...
});

// is equivalent to this:
const signer = jws.createSign({
  header: { alg: 'RS256' },
});
privateKeyStream.pipe(signer.privateKey);
payloadStream.pipe(signer.payload);
signer.on('done', function(signature) {
  // ...
});
```

## <a name="jwscreateverifyoptions"></a>jws.createVerify(options)

إرجاع كائن VerifyStream جديد.

خيارات:

* `signature`
* `algorithm`
* `key` || `publicKey` || `secret`
* `encoding` (Optional, defaults to 'utf8')

تتوقع جميع الخيارات سلسلة أو مخزن مؤقت عندما تكون القيمة معروفة في وقت مبكر، أو دفق للراحة.

مثال:

```js

// This...
jws.createVerify({
  publicKey: pubKeyStream,
  signature: sigStream,
}).on('done', function(verified, obj) {
  // ...
});

// is equivilant to this:
const verifier = jws.createVerify();
pubKeyStream.pipe(verifier.publicKey);
sigStream.pipe(verifier.signature);
verifier.on('done', function(verified, obj) {
  // ...
});
```

## <a name="class-signstream"></a>الفئة: SignStream

`Readable Stream` التي تنبعث منها حدث بيانات واحد (التوقيع المحسوب) عند الانتهاء.

### <a name="event-done"></a>الحدث: "تم"
`function (signature) { }`

### <a name="signerpayload"></a>signer.payload

`Writable Stream` التي تتوقع حمولة JWS. *لا* تستخدم إذا قمت بتمرير خيار `payload` إلى المنشئ.

مثال:

```js
payloadStream.pipe(signer.payload);
```

### <a name="signersecretbrsignerkeybrsignerprivatekey"></a>signer.secret<br>signer.key<br>signer.privateKey

`Writable Stream`. يتوقع سر JWS لـHMAC، أو المفتاح الخاص لـECDSA وRSA. *لا* تستخدم إذا قمت بتمرير خيار `secret` أو `key` إلى المنشئ.

مثال:

```js
privateKeyStream.pipe(signer.privateKey);
```

## <a name="class-verifystream"></a>الفئة: VerifyStream

هذا هو `Readable Stream` الذي ينبعث منه حدث بيانات واحد، نتيجة لما إذا كان هذا التوقيع صالحًا أم لا.

### <a name="event-done"></a>الحدث: "تم"
`function (valid, obj) { }`

`valid` منطقي لمعرفة ما إذا كان التوقيع صالحًا أم لا.

### <a name="verifiersignature"></a>verifier.signature

`Writable Stream` التي تتوقع توقيع JWS. *لا* تستخدم إذا قمت بتمرير خيار `signature` إلى المنشئ.

### <a name="verifiersecretbrverifierkeybrverifierpublickey"></a>verifier.secret<br>verifier.key<br>verifier.publicKey

`Writable Stream` التي تتوقع مفتاحًا عامًا أو سرًا. *لا* تستخدم إذا قمت بتمرير خيار `key` أو `secret` إلى المنشئ.

# <a name="todo"></a>TODO

* يبدو أنه يجب أن يكون هناك بعض خيارات الراحة / واجهات برمجة التطبيقات لتحديد الخوارزمية بدلًا من الاضطرار إلى تعريف كائن رأس مع `{ alg: 'ES512' }` أو أيًا كان في كل مرة.

* X.509 support, ugh

# <a name="license"></a>الترخيص

معهد ماساتشوستس للتكنولوجيا

```
Copyright (c) 2013-2015 Brian J. Brennan

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```

[encrypted-key-docs]: https://nodejs.org/api/crypto.html#crypto_sign_sign_private_key_output_format
